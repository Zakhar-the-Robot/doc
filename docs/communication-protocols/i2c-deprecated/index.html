<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This file describes I2C communication used by Zakhar&rsquo;s systems
Basic description #   Standard uses 7-bit addressing. Devices can have data located in 0x02&mldr;0xFE registers - 253 bytes Each device mandatorily has registers 0x00 to store command, 0x01 for arguments, and 0x02 to store device state. Commands should be represented by values 0x01&mldr;0xFE Read and write operations are described bellow  Registers #  Minimal register map:
 REG_CMD - Command register."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://zakhar-the-robot.github.io/doc/docs/communication-protocols/i2c-deprecated/"><title>I2c ( Deprecated) | Zakhar the Robot</title><link rel=manifest href=/doc/manifest.json><link rel=icon href=/doc/favicon.png type=image/x-icon><link rel=stylesheet href=/doc/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/doc/flexsearch.min.js></script>
<script defer src=/doc/en.search.min.c8597cc5e62df23f10f80417a9d15230a0bddd573985c4dfe76c0a265345b965.js integrity="sha256-yFl8xeYt8j8Q+AQXqdFSMKC93Vc5hcTf52wKJlNFuWU=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=https://zakhar-the-robot.github.io/doc/docs/communication-protocols/i2c-deprecated/index.xml title="Zakhar the Robot"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/doc/><span>Zakhar the Robot</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Communication Protocols</span><ul><li><a href=/doc/docs/communication-protocols/canbus/>Canbus</a></li><li><a href=/doc/docs/communication-protocols/i2c-deprecated/ class=active>I2c ( Deprecated)</a><ul></ul></li></ul></li><li><a href=/doc/docs/systems/>Systems and Components</a><ul><li><span>Motion</span><ul><li><a href=/doc/docs/systems/motion/wheeled-platform/>Motors</a><ul></ul></li></ul></li><li><a href=/doc/docs/systems/brain/>Brain</a><ul><li><a href=/doc/docs/systems/brain/ros_install/>Ros Install</a></li></ul></li><li><a href=/doc/docs/systems/io/>IO</a><ul></ul></li></ul></li></ul><ul><li><a href=/doc/for_developers target=_blank rel=noopener>‚≠ê For Developers ‚Üó</a></li><li><a href=https://github.com/Zakhar-the-Robot target=_blank rel=noopener>üìú Sources ‚Üó</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/doc/svg/menu.svg class=book-icon alt=Menu></label>
<strong>I2c ( Deprecated)</strong>
<label for=toc-control><img src=/doc/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#basic-description>Basic description</a></li><li><a href=#registers>Registers</a></li><li><a href=#readwrite-operations>Read/Write operations</a></li><li><a href=#command-writing-process>Command writing process</a><ul><li><a href=#full-process>Full process</a></li><li><a href=#simplified-process>Simplified process</a></li></ul></li></ul></nav></aside></header><article class=markdown><p>This file describes I2C communication used by Zakhar&rsquo;s systems</p><h2 id=basic-description>Basic description
<a class=anchor href=#basic-description>#</a></h2><ul><li>Standard uses 7-bit addressing.</li><li>Devices can have data located in 0x02&mldr;0xFE registers - 253 bytes</li><li>Each device mandatorily has registers 0x00 to store command, 0x01 for arguments, and 0x02 to store device state.</li><li>Commands should be represented by values 0x01&mldr;0xFE</li><li>Read and write operations are described bellow</li></ul><h2 id=registers>Registers
<a class=anchor href=#registers>#</a></h2><p>Minimal register map:</p><img src=Regs.svg width=150><ul><li><code>REG_CMD</code> - Command register. The device is reading commands from here</li><li><code>REG_ARG</code> - Optional argument of the command</li><li><code>REG_MODE</code> - Mode register. If device support working in several modes, this register should be used to indicate it.</li><li>other addresses can be used for device specific data</li></ul><h2 id=readwrite-operations>Read/Write operations
<a class=anchor href=#readwrite-operations>#</a></h2><p>To read master should consequently:</p><ul><li>Send Start state</li><li>Send Write command</li><li>Send Register number</li><li>Send Start state</li><li>Send Read command</li><li>Read byte(s)</li><li>Send NACK</li><li>Send Stop state</li></ul><p>Then read one byte - the value from the register</p><img src=Read.svg width=800><p>To write data master should consequently:</p><ul><li>Send Start state</li><li>Send Write command</li><li>Send Register number</li><li>Send Data byte(s)</li><li>Send Stop state</li></ul><img src=Write.svg width=600><h2 id=command-writing-process>Command writing process
<a class=anchor href=#command-writing-process>#</a></h2><h3 id=full-process>Full process
<a class=anchor href=#full-process>#</a></h3><ul><li>A) Master read the <code>REG_CMD</code> register. If it is not 0x00 - slave should be considered as busy.</li><li>B) If slave is not busy Master writes <code>0xFF</code> to <code>REG_CMD</code></li><li>C) Optionally write argument to <code>REG_ARG</code></li><li>D) Master writes a command to the <code>REG_CMD</code> (command is any value in the range <code>0x01</code>&mldr;<code>0xFE</code>)</li><li>E) When the command is executed, slave sets CMD and ARG registers to 0x00</li></ul><img src=./Cmd.svg width=500><h3 id=simplified-process>Simplified process
<a class=anchor href=#simplified-process>#</a></h3><ul><li>A) (optionally) Write an argument to <code>REG_ARG</code></li><li>B) Write a command to <code>REG_CMD</code></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://zakhar-the-robot.github.io/doc//commit/1e70be68bd29b356c25b58f69ea5a09a4cd79531 title="Last modified by Andrei Gramakov |  2022-May-12" target=_blank rel=noopener><img src=/doc/svg/calendar.svg class=book-icon alt=Calendar>
<span>2022-May-12</span></a></div></div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#basic-description>Basic description</a></li><li><a href=#registers>Registers</a></li><li><a href=#readwrite-operations>Read/Write operations</a></li><li><a href=#command-writing-process>Command writing process</a><ul><li><a href=#full-process>Full process</a></li><li><a href=#simplified-process>Simplified process</a></li></ul></li></ul></nav></div></aside></main></body></html>